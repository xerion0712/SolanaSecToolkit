
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solana Security Report</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto; margin: 0; padding: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 8px 8px 0 0; }
        .content { padding: 30px; }
        .summary { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: #f8f9fa; padding: 20px; border-radius: 8px; text-align: center; }
        .stat-number { font-size: 2em; font-weight: bold; margin-bottom: 5px; }
        .critical { color: #dc3545; }
        .high { color: #fd7e14; }
        .medium { color: #ffc107; }
        .low { color: #28a745; }
        .issue { border-left: 4px solid #dee2e6; margin: 10px 0; padding: 15px; background: #f8f9fa; border-radius: 4px; }
        .issue.critical { border-left-color: #dc3545; }
        .issue.high { border-left-color: #fd7e14; }
        .issue.medium { border-left-color: #ffc107; }
        .issue.low { border-left-color: #28a745; }
        .code { background: #f1f3f4; padding: 10px; border-radius: 4px; font-family: monospace; margin: 10px 0; }
        .recommendations { background: #e3f2fd; padding: 20px; border-radius: 8px; margin-top: 30px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è Solana Security Report</h1>
            <p>Generated on 2025-06-23T07:52:19.582236Z by solsec v0.1.2</p>
        </div>
        
        <div class="content">
            <div class="summary">
                <div class="stat-card">
                    <div class="stat-number">29</div>
                    <div>Total Issues</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number critical">0</div>
                    <div>Critical</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number high">8</div>
                    <div>High</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number medium">21</div>
                    <div>Medium</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number low">0</div>
                    <div>Low</div>
                </div>
            </div>

            <h2>Security Issues</h2>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/reentrancy/secure.rs (Line 78)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// SECURE: Checks-Effects-Interactions pattern</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/reentrancy/vulnerable.rs (Line 30)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// VULNERABLE: State changes after external call - reentrancy possible!</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/reentrancy/vulnerable.rs (Line 63)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// VULNERABLE: Cross-program invocation with state changes</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/integer_overflow/vulnerable.rs (Line 11)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let result &#x3D; a + b;</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/integer_overflow/vulnerable.rs (Line 18)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let total &#x3D; amount * multiplier;</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/integer_overflow/vulnerable.rs (Line 24)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// VULNERABLE: In-place addition without checking</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/integer_overflow/vulnerable.rs (Line 31)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let total_cost &#x3D; quantity * price_per_unit;</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/integer_overflow/vulnerable.rs (Line 34)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let fee &#x3D; total_cost + 100;</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/secure.rs (Line 10)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn transfer_funds_handler(ctx: Context&lt;TransferFunds&gt;, amount: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/secure.rs (Line 33)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn admin_instruction(ctx: Context&lt;AdminAction&gt;, new_admin: Pubkey) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/secure.rs (Line 45)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn withdraw_handler(ctx: Context&lt;Withdraw&gt;, amount: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/secure.rs (Line 62)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn update_price_instruction(ctx: Context&lt;UpdatePrice&gt;, new_price: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/missing_signer_check/vulnerable.rs (Line 9)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// VULNERABLE: No signer validation - anyone can call this</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/vulnerable.rs (Line 10)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn transfer_funds_handler(ctx: Context&lt;TransferFunds&gt;, amount: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/vulnerable.rs (Line 22)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn admin_instruction(ctx: Context&lt;AdminAction&gt;, new_admin: Pubkey) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/vulnerable.rs (Line 29)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn withdraw_handler(ctx: Context&lt;Withdraw&gt;, amount: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue high">
                <h3>missing_signer_check</h3>
                <p><strong>File:</strong> examples/missing_signer_check/vulnerable.rs (Line 36)</p>
                <p><strong>Severity:</strong> high</p>
                <p>Instruction handler may be missing signer validation</p>
                <div class="code">pub fn update_price_instruction(ctx: Context&lt;UpdatePrice&gt;, new_price: u64) -&gt; Result&lt;()&gt; {</div>
                <p><strong>Suggestion:</strong> Add signer validation to prevent unauthorized access</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/dangerous_unwrap/secure.rs (Line 66)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// SECURE: Handle invalid UTF-8 gracefully</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/dangerous_unwrap/secure.rs (Line 134)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">#[msg(&quot;Invalid UTF-8 data provided&quot;)]</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/dangerous_unwrap/vulnerable.rs (Line 48)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// DANGEROUS: Could panic on invalid UTF-8</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/secure.rs (Line 46)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">// SECURE: Type-safe modification through Account wrapper</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/secure.rs (Line 76)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">msg!(&quot;Validated accounts - From: {}, To: {}&quot;,</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/secure.rs (Line 131)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">space &#x3D; 8 + UserAccount::INIT_SPACE</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 33)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">raw_data.as_ptr() as *const u64,</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 53)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let ptr &#x3D; account_data.as_mut_ptr() as *mut u64;</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 68)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">let balance &#x3D; unsafe { *(data.as_ptr() as *const u64) };</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 78)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">/// CHECK: This is dangerous - no validation of account type</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 84)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">/// CHECK: Unsafe - could be any account</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>
            <div class="issue medium">
                <h3>integer_overflow</h3>
                <p><strong>File:</strong> examples/unchecked_account/vulnerable.rs (Line 90)</p>
                <p><strong>Severity:</strong> medium</p>
                <p>Potential integer overflow. Consider using checked arithmetic operations.</p>
                <div class="code">/// CHECK: No validation - direct manipulation</div>
                <p><strong>Suggestion:</strong> Use checked_add(), checked_sub(), or checked_mul()</p>
            </div>

            <div class="recommendations">
                <h2>üìã Recommendations</h2>
                <ul>
                    <li>‚ö†Ô∏è  8 high-severity issues require attention.</li>
                    <li>Add signer validation to 8 instruction handlers.</li>
                    <li>Consider using checked arithmetic operations for 21 overflow-prone locations.</li>
                    <li>Run tests after fixing issues to ensure functionality is preserved.</li>
                    <li>Consider setting up CI/CD integration to catch issues early.</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>
